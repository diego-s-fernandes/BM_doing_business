---
title: "db-2020"
author: "Diego dos Santos Fernandes"
date: "03/01/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyverse)
library(ggrepel)
library(readxl)
library(stargazer)
library(gghighlight)
library(ggpubr)
library(ggthemes)
library(gridExtra)
library(corrplot)
library(GGally)
library(devtools)
library(janitor)
library(hablar)
library(patchwork)
library(dplyr)
library(esquisse)


#remotes::install_github("anthonynorth/rscodeio")
#https://github.com/anthonynorth/rscodeio
#rscodeio::install_theme()
```

```{r}
library(readxl)
DB2020 <- read_excel("DB2020.xlsx", sheet = "All data", 
    skip = 3)

```

# dados da Pontuação EoDB
## Unificar as metodologias mais atuais
```{r}

eodb <- DB2020[ ,1:9]
eodb <- eodb[ ,-6]
eodb <- eodb %>%  janitor::clean_names() %>% janitor::remove_empty(c("rows","cols"))

eodb <- eodb %>% 
  mutate( pontuacao = dplyr::coalesce(ease_of_doing_business_score_db17_20_methodology,ease_of_doing_business_score_db15_methodology,ease_of_doing_business_score_db10_14_methodology))
eodb <- eodb[ , c(1:5,9)] 
eodb <- eodb %>% na.omit()




```

## tratando as informações com países com coleta de dados em duas cidades

```{r}
#usando o Rbase para renomear as linhas
eodb$economy[eodb$economy == "Brazil São Paulo" & eodb$db_year <= 2013] <- "Brazil"
eodb$economy[eodb$economy == "Russian Federation Moscow" & eodb$db_year <= 2013] <- "Russian Federation"
eodb$economy[eodb$economy == "China Shanghai" & eodb$db_year <= 2013] <- "China"
eodb$economy[eodb$economy == "India Mumbai" & eodb$db_year <= 2013] <- "India"
eodb$economy[eodb$economy == "Japan Tokyo" & eodb$db_year <= 2013] <- "Japan"
eodb$economy[eodb$economy == "Mexico Mexico City" & eodb$db_year <= 2013] <- "Mexico"

# usando o dplyr para fazer a mesma coisa
eodb <- eodb %>% 
    mutate( economy = if_else(economy == "United States New York City" & db_year <= 2013, "United States", economy),
            economy = if_else(economy == "Pakistan Karachi" & db_year <= 2013, "Pakistan", economy),
            economy = if_else(economy == "Bangladesh Dhaka" & db_year <= 2013, "Bangladesh", economy),
            economy = if_else(economy == "Indonesia Jakarta" & db_year <= 2013, "Indonesia", economy),
            economy = if_else(economy == "Nigeria Lagos" & db_year <= 2013, "Nigeria", economy),
             
                )

eodb$db_year <- as_factor(eodb$db_year)

#arredondando os valores da pontuação

eodb <- eodb %>% 
  mutate(pontuacao = round(pontuacao, 2))

```


```{r}
brasil_1 <- eodb %>% 
  filter(economy == "Brazil")

ggplot(brasil_1) +
 aes(x = db_year, y = pontuacao) +
 geom_bar(stat="identity", fill = "#31688e") +
  scale_y_continuous(limits = c(0,100))+
  geom_text(aes(label= pontuacao), position = position_dodge(1), vjust = -0.2 )+
 labs(x = "Ano", 
      y = "pontuação", 
      title = "Facilidade em se fazer negócios no Brasil", 
      subtitle = "A pontuação mede de forma geral o aombiente de negócios de um país", 
      caption = "Fonte: Banco Mundial") +
 theme_minimal()+
  theme(plot.caption=element_text(size=10, hjust=0))




```

## último relatório Brics
```{r}
brics_2020 <- eodb %>% 
  filter(economy %in% c("Brazil", "Russian Federation", "China", "India", "South Africa"), db_year == 2020)


brics_2020 %>% 
  ggplot(aes(x = economy, y = pontuacao)) +
 geom_bar(stat="identity", fill = "#31688e") +
  scale_y_continuous(limits = c(0,100))+
  geom_text(aes(label= pontuacao), position = position_dodge(1), vjust = 2, color = "white", size = 5 )+
 labs(x = "Ano", 
      y = "pontuação", 
      title = "Facilidade em se fazer negócios Brics", 
      subtitle = "A pontuação mede de forma geral o aombiente de negócios de um país", 
      caption = "Fonte: Banco Mundial") +
 theme_minimal()+
  theme(plot.caption=element_text(size=10, hjust=0))
```


















